(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20ed99"],{b0b7:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v(e._s(e.id?"编辑":"新建")+"视频")]),a("el-form",{attrs:{"label-width":"120px"},nativeOn:{submit:function(t){return t.preventDefault(),e.save.apply(null,arguments)}}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{staticStyle:{width:"20rem"},attrs:{placeholder:"请输入视频标题"},model:{value:e.model.title,callback:function(t){e.$set(e.model,"title",t)},expression:"model.title"}})],1),a("el-form-item",{attrs:{label:"作者"}},[a("el-input",{staticStyle:{width:"20rem"},attrs:{placeholder:"请输入作者名称"},model:{value:e.model.author,callback:function(t){e.$set(e.model,"author",t)},expression:"model.author"}})],1),a("el-form-item",{attrs:{label:"头像"}},[a("span",{staticClass:"text-grey fs-xs"},[e._v("tip:建议使用宽:高=1:1图片")]),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadURl,headers:e.getAuthHeaders(),"show-file-list":!1,"on-success":function(t){return e.$set(e.model,"avatar",t.url)}}},[e.model.avatar?a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.model.avatar,expression:"model.avatar"}],staticClass:"avatar"}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"所属分类"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.model.category,callback:function(t){e.$set(e.model,"category",t)},expression:"model.category"}},e._l(e.categories,(function(e){return a("el-option",{key:e._id,attrs:{label:e.name,value:e._id}})})),1)],1),a("el-form-item",{attrs:{label:"粉丝数"}},[a("el-input",{staticStyle:{width:"20rem"},attrs:{placeholder:"请输入作者粉丝数量"},model:{value:e.model.fans,callback:function(t){e.$set(e.model,"fans",t)},expression:"model.fans"}})],1),a("el-form-item",{attrs:{label:"播放量"}},[a("el-input",{staticStyle:{width:"20rem"},attrs:{placeholder:"请输入视频播放量"},model:{value:e.model.play,callback:function(t){e.$set(e.model,"play",t)},expression:"model.play"}})],1),a("el-form-item",{attrs:{label:"封面"}},[a("span",{staticClass:"text-grey fs-xs"},[e._v("tip:建议使用宽屏图片，宽:高=2:1最佳")]),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadURl,headers:e.getAuthHeaders(),"show-file-list":!1,"on-success":function(t){return e.$set(e.model,"cover",t.url)}}},[e.model.cover?a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.model.cover,expression:"model.cover"}],staticClass:"avatar"}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"视频"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadURl,"show-file-list":!1,headers:e.getAuthHeaders(),"on-success":function(t){return e.$set(e.model,"video",t.url)},"before-upload":e.beforeVideo}},[e.model.video?a("video",{staticClass:"avatar",attrs:{controls:"",src:e.model.video}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",[a("el-button",{attrs:{type:"warning","native-type":"el-submit"}},[e._v("保存")])],1)],1)],1)},s=[],l=a("1da1"),o=(a("96cf"),{props:{id:{}},data:function(){return{model:{title:"",category:"",play:"",cover:"",video:""},categories:[]}},methods:{save:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.model.title){t.next=3;break}return e.$message.error("视频标题不能为空"),t.abrupt("return");case 3:if(!e.id){t.next=9;break}return t.next=6,e.$http.put("rest/videos/".concat(e.id),e.model);case 6:t.sent,t.next=12;break;case 9:return t.next=11,e.$http.post("rest/videos",e.model);case 11:t.sent;case 12:e.$router.push("/videos/list"),e.$message({type:"success",message:"保存成功"});case 14:case"end":return t.stop()}}),t)})))()},fetch:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("rest/videos/".concat(e.id));case 2:a=t.sent,e.model=Object.assign({},e.model,a.data);case 4:case"end":return t.stop()}}),t)})))()},fetchCategories:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("rest/videos/cate");case 2:a=t.sent,e.categories=a.data;case 4:case"end":return t.stop()}}),t)})))()},beforeVideo:function(e){if(-1==e.type.indexOf("video"))return this.$message.error("上传的文件不符合格式"),!1}},created:function(){this.id&&this.fetch(),this.fetchCategories()}}),i=o,n=a("2877"),c=Object(n["a"])(i,r,s,!1,null,null,null);t["default"]=c.exports}}]);
//# sourceMappingURL=chunk-2d20ed99.68fda6eb.js.map